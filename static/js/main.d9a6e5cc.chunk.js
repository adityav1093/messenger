(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{23:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},26:function(e,t,a){e.exports=a(39)},31:function(e,t,a){},32:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(22),o=a.n(r),c=(a(31),a(8)),i=a(9),l=a(16),u=a(15),m=a(1),g=(a(32),a(10)),h=a(3),d="20373144ffd654e",E="b2c21e3a4975a0990f15f0db3d889616fa829b55",p="supergroup",f=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,null,[{key:"init",value:function(){var e=(new h.CometChat.AppSettingsBuilder).subscribePresenceForAllUsers().setRegion("us").build();h.CometChat.init(d,e)}},{key:"getTextMessage",value:function(e,t,a){return"user"===a?new h.CometChat.TextMessage(e,t,h.CometChat.RECEIVER_TYPE.USER,h.CometChat.MESSAGE_TYPE.TEXT):new h.CometChat.TextMessage(e,t,h.CometChat.RECEIVER_TYPE.GROUP,h.CometChat.MESSAGE_TYPE.TEXT)}},{key:"getLoggedinUser",value:function(){return h.CometChat.getLoggedinUser()}},{key:"login",value:function(e){return h.CometChat.login(e,this.apiKey)}},{key:"getGroupMessages",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,n=(new h.CometChat.MessagesRequestBuilder).setGUID(e).setLimit(a).build();return t(),n.fetchPrevious()}},{key:"sendGroupMessage",value:function(e,t){var a=this.getTextMessage(e,t,"group");return h.CometChat.sendMessage(a)}},{key:"joinGroup",value:function(e){return h.CometChat.joinGroup(e,h.CometChat.GROUP_TYPE.PUBLIC,"")}},{key:"addMessageListener",value:function(e){h.CometChat.addMessageListener(this.LISTENER_KEY_MESSAGE,new h.CometChat.MessageListener({onTextMessageReceived:function(t){e(t)}}))}}]),e}();f.LISTENER_KEY_MESSAGE="msglistener",f.appId=d,f.apiKey=E,f.LISTENER_KEY_GROUP="grouplistener";var v=a(23),C=a.n(v),b=function(){var e=Object(n.useState)(""),t=Object(g.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),c=Object(g.a)(o,2),i=c[0],l=c[1],u=Object(n.useState)(""),h=Object(g.a)(u,2),d=h[0],E=h[1],p=Object(n.useState)(!1),v=Object(g.a)(p,2),b=v[0],O=v[1],y=Object(n.useState)(""),M=Object(g.a)(y,2),S=M[0],T=M[1];Object(n.useEffect)((function(){f.init()}),[]);var j=function(){O(!0),f.login(a).then((function(e){E(e),l(!0)})).catch((function(e){T("Please enter a valid username"),O(!1),console.log(e)}))};return s.a.createElement("div",null,i&&s.a.createElement(m.a,{to:{pathname:"/chat",state:{user:d}}}),s.a.createElement("div",{className:"App"},s.a.createElement("h1",{style:{color:"Grey"}},"GROUP MESSENGER BY AV"),s.a.createElement("form",{className:"form",onSubmit:function(e){""!==a&&(e.preventDefault(),j())}},s.a.createElement("input",{onChange:function(e){r(e.target.value)},type:"text"}),s.a.createElement("span",{className:"error"},S),s.a.createElement("div",null),b?s.a.createElement("img",{src:C.a,alt:"Spinner component",className:"App-logo"}):s.a.createElement("input",{type:"submit",disabled:""===a,value:"LOGIN"}))))},O=a(25),y=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleLogout=function(){localStorage.clear(),n.props.history.push("/")},n.sendMessage=function(){f.sendGroupMessage(n.GUID,n.state.messageText).then((function(e){console.log("Message sent successfully:",e),n.createData(null),n.setState({messageText:null})}),(function(e){"ERR_NOT_A_MEMBER"===e.code?f.joinGroup(n.GUID).then((function(e){n.sendMessage()})):console.log(e)}))},n.scrollToBottom=function(){var e=document.getElementById("chatList");e.scrollTop=e.scrollHeight},n.handleSubmit=function(e){e.preventDefault(),n.sendMessage(),e.target.reset()},n.handleChange=function(e){n.setState({messageText:e.target.value})},n.getUser=function(){f.getLoggedinUser().then((function(e){console.log("user details:",{user:e}),n.setState({user:e})})).catch((function(e){var t=e.error;t&&"USER_NOT_LOGED_IN"===t.code&&n.setState({isAuthenticated:!1})}))},n.messengerCallback=function(e){console.log(e)},n.messageListener=function(){f.addMessageListener((function(e,t){if(t)return console.log("error: ".concat(t));n.createData(e)}))},n.state={receiverID:"",messageText:null,groupMessage:[],user:{},isAuthenticated:!0},n.GUID=p,n}return Object(i.a)(a,[{key:"createData",value:function(e){var t=this,a={};if(e)a={uid:e.sender.uid,name:e.sender.name,message:e.data.text};else{var n=this.state.user,s=this.state.messageText;a={uid:n.uid,name:n.name,message:s}}this.setState((function(e){return{groupMessage:[].concat(Object(O.a)(e.groupMessage),[a])}}),(function(){t.scrollToBottom()}))}},{key:"componentDidMount",value:function(){this.getUser(),this.messageListener()}},{key:"render",value:function(){var e=this;return this.state.isAuthenticated?s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("h3",null,"Messenger Mode :",s.a.createElement("span",{style:{color:"Grey"}}," Group Chat ")," ",".... Current User :"," ",s.a.createElement("span",{style:{color:"Orange"}},this.state.user.name," ")),s.a.createElement("button",{className:"btn btn-primary float-right",onClick:this.handleLogout},"LogOut")),s.a.createElement("div",{className:"chatWindow"},s.a.createElement("ul",{className:"chat",id:"chatList"},this.state.groupMessage.map((function(t,a){return s.a.createElement("div",{key:a},e.state.user.uid===t.uid?s.a.createElement("li",{className:"self"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.name),s.a.createElement("div",{className:"message",style:{color:"Orange"}}," ",t.message))):s.a.createElement("li",{className:"other"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.name),s.a.createElement("div",{className:"message",style:{color:"red"}}," ",t.message," "))))}))),s.a.createElement("div",{className:"chatInputWrapper"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{className:"textarea input",type:"text",placeholder:"Enter your message...",onChange:this.handleChange}))))):s.a.createElement(m.a,{to:"/"})}}]),a}(s.a.Component),M=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement(m.d,null,s.a.createElement(m.a,{exact:!0,from:"/",to:"/login"}),s.a.createElement(m.b,{path:"/login",component:b}),s.a.createElement(m.b,{path:"/chat",component:y}))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=a(11),T=(a(38),a(4)),j=Object(T.a)();o.a.render(s.a.createElement(S.a,{history:j},s.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.d9a6e5cc.chunk.js.map